<!-- static/html/pdf_display.html -->
<div class="pdf-display-xblock" aria-live="polite">
    <div class="pdf-header">
        <h3 id="pdf-display-title">{{ pdf_title }}</h3>
        {% if show_download_button and pdf_url %}
        <div class="pdf-controls">
            <a href="{{ pdf_url }}" download target="_blank" class="btn btn-primary" aria-label="Download PDF">
                Download PDF
            </a>
        </div>
        {% endif %}
    </div>

    {% if available_pdfs %}
    <div class="pdf-selector" role="region" aria-labelledby="pdf-display-title">
        <label for="pdf-select">Choose PDF:</label>
        <select id="pdf-select" class="pdf-select" aria-label="Choose PDF">
            <option value="">Select a PDF...</option>
            {% for pdf in available_pdfs %}
            <option value="{{ pdf.path }}" {% if pdf.path == current_pdf_file %}selected{% endif %}>
                {{ pdf.name }} ({{ pdf.size }})
            </option>
            {% endfor %}
        </select>
    </div>
    {% endif %}

    {% if allow_upload %}
    <div class="pdf-upload" role="form" aria-label="Upload PDF">
        <form id="pdf-upload-form" method="post" enctype="multipart/form-data" novalidate>
            <div class="upload-area">
                <label for="pdf-file-input" class="sr-only">PDF file</label>
                <input type="file" id="pdf-file-input" name="pdf_file" accept=".pdf" aria-describedby="upload-help" />
                <button type="submit" class="btn btn-success" id="upload-btn">Upload PDF</button>
            </div>

            <div class="progress" id="upload-progress" aria-hidden="true" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                <div class="bar" style="width: 0%;"></div>
            </div>

            <div id="upload-status" class="upload-status" role="status" aria-live="polite"></div>
            <div id="upload-help" class="sr-only">Accepted format: PDF. Max size: 10MB.</div>
        </form>
    </div>
    {% endif %}

    <div class="pdf-content" id="pdf-content">
        {% if pdf_url %}
        <div class="iframe-wrap" style="position: relative;">
            <div class="loading-overlay hidden" id="iframe-loading">Loadingâ€¦</div>
            <iframe id="pdf-iframe" 
                    src="{{ pdf_url }}"
                    width="{{ width }}"
                    height="{{ height }}"
                    style="border: 1px solid #ccc; display: block;"
                    title="{{ pdf_title }}"
                    aria-label="{{ pdf_title }}">
                <p>Your browser does not support PDFs.
                   <a href="{{ pdf_url }}" target="_blank">Download the PDF</a>.
                </p>
            </iframe>
        </div>
        {% else %}
        <div class="alert alert-warning">
            <strong>No PDF selected.</strong><br>
            Please select a PDF from the list above or upload a new one.
        </div>
        {% endif %}
    </div>
</div>
